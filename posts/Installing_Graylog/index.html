<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Installing and Configuring Graylog" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://darkcybe.github.io/posts/Installing_Graylog/" /><meta property="og:url" content="https://darkcybe.github.io/posts/Installing_Graylog/" /><meta property="og:site_name" content="darkcybe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-24T00:00:00+11:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Installing and Configuring Graylog" /><meta name="twitter:site" content="@darkcybe" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-24T00:00:00+11:00","datePublished":"2022-12-24T00:00:00+11:00","description":"Overview","headline":"Installing and Configuring Graylog","mainEntityOfPage":{"@type":"WebPage","@id":"https://darkcybe.github.io/posts/Installing_Graylog/"},"url":"https://darkcybe.github.io/posts/Installing_Graylog/"}</script><title>Installing and Configuring Graylog | darkcybe</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="darkcybe"><meta name="application-name" content="darkcybe"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/darkcybe.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">darkcybe</a></div><div class="site-subtitle font-italic">This is the security blog you've been looking for</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/darkcybe" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/darkcybe" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://discordapp.com/users/darkcybe#4349" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Installing and Configuring Graylog</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Installing and Configuring Graylog</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1671800400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 24, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/darkcybe">darkcybe</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1031 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h2 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Graylog provides answers to your teamâ€™s security, application, and IT infrastructure questions by enabling you to combine, enrich, correlate, query, and visualize all your log data in one place.</p><h2 id="installing-graylog-50-on-ubuntu-2004"><span class="mr-2">Installing Graylog 5.0 on Ubuntu 20.04</span><a href="#installing-graylog-50-on-ubuntu-2004" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="prerequisites"><span class="mr-2"><strong>Prerequisites</strong></span><a href="#prerequisites" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Graylog 5.0 requires the following to maintain compatibility with its software dependencies:</p><ul><li>OpenJDK 17 (embedded in the 5.0 installation file)<li>Elasticsearch 7.10.2Â <strong><em>OR</em></strong>Â OpenSearch 2.x<li>MongoDB (5.x or 6.x)</ul><h3 id="installing-mongodb-61"><span class="mr-2">Installing MongoDB 6.1</span><a href="#installing-mongodb-61" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Import the public key used by APT and add the repository to the APT sources file. Once completed, MongoDB can be installed after updating the package database.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>wget <span class="nt">-qO</span> - https://www.mongodb.org/static/pgp/server-6.0.asc | <span class="nb">sudo </span>apt-key add -
<span class="nb">echo</span> <span class="s2">"deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse"</span> | <span class="nb">sudo tee</span> /etc/apt/sources.list.d/mongodb-org-6.0.list
<span class="nb">sudo </span>apt-get update
<span class="nb">sudo </span>apt-get <span class="nb">install</span> <span class="nt">-y</span> mongodb-org
</pre></table></code></div></div><ol><li>Enable the MongoDB service to start at boot</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl daemon-reload
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>mongod.service
<span class="nb">sudo </span>systemctl restart mongod.service
<span class="nb">sudo </span>systemctl status mongod.service <span class="c"># Check that the service is active</span>
</pre></table></code></div></div><h3 id="installing-opensearch-241"><span class="mr-2">Installing OpenSearch 2.4.1</span><a href="#installing-opensearch-241" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Graylog supports running on either Elasticsearch or OpenSearch. The preference is entirely up to you, however I choose to run OpenSearch as it is opensource and includes a few enhanced features over ElasticSearch 7.10.2. For a more detailed reference on the difference between the two, see the referenced blog post.</p><ol><li>Check the <code class="language-plaintext highlighter-rouge">vm.max_map_count</code> setting to ensure that it is set to at least 262144 and disable memory paging and swapping to improve performance.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">cat</span> /proc/sys/vm/max_map_count <span class="c"># Checks the current max_map_count</span>
<span class="nb">sudo </span>nano /etc/sysctl.conf
	vm.max_map_count<span class="o">=</span>262144 <span class="c"># Enter this line to sysctl.conf</span>
<span class="nb">sudo </span>sysctl <span class="nt">-p</span> <span class="c"># Reload the new setting</span>
<span class="nb">sudo </span>swapoff <span class="nt">-a</span>
</pre></table></code></div></div><ol><li>Create a User and Group for the OpenSearch app and create directories to store the application data and log files.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>adduser <span class="nt">--system</span> <span class="nt">--disabled-password</span> <span class="nt">--disabled-login</span> <span class="nt">--home</span> /var/empty <span class="nt">--no-create-home</span> <span class="nt">--quiet</span> <span class="nt">--force-badname</span> <span class="nt">--group</span> opensearch
<span class="nb">sudo mkdir</span> <span class="nt">-p</span> /graylog/opensearch/data
<span class="nb">sudo mkdir</span> /var/log/opensearch
</pre></table></code></div></div><ol><li>Download and extract the appropriate tar.gz archive, in this case it is the x64 version. Move the extracted data into the previously created directory.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>wget https://artifacts.opensearch.org/releases/bundle/opensearch/2.4.1/opensearch-2.4.1-linux-x64.tar.gz
<span class="nb">tar</span> <span class="nt">-xvf</span> opensearch-2.4.1-linux-x64.tar.gz
<span class="nb">sudo mv </span>opensearch-2.4.1/<span class="k">*</span> /graylog/opensearch/
<span class="nb">sudo rm</span> <span class="nt">-rf</span> opensearch<span class="k">*</span> <span class="c"># Clean up the downloaded tar archive</span>
</pre></table></code></div></div><ol><li>Set appropriate permissions for the OpenSearch app for the previously created opensearch user and group. Create an empty log file under the same user account.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nb">sudo chown</span> <span class="nt">-R</span> opensearch:opensearch /graylog/opensearch/
<span class="nb">sudo chown</span> <span class="nt">-R</span> opensearch:opensearch /var/log/opensearch
<span class="nb">sudo chmod</span> <span class="nt">-R</span> 2750 /graylog/opensearch/
<span class="nb">sudo chmod</span> <span class="nt">-R</span> 2750 /var/log/opensearch
<span class="nb">sudo</span> <span class="nt">-u</span> opensearch <span class="nb">touch</span> /var/log/opensearch/graylog.log
</pre></table></code></div></div><ol><li>Create a system service</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>su
<span class="nb">cat</span> <span class="o">&gt;</span> /etc/systemd/system/opensearch.service <span class="o">&lt;&lt;</span><span class="no">EOF</span><span class="sh">
[Unit]
Description=Opensearch
Documentation=https://opensearch.org/docs/latest
Requires=network.target remote-fs.target
After=network.target remote-fs.target
ConditionPathExists=/graylog/opensearch
ConditionPathExists=/graylog/opensearch/data
[Service]
Environment=OPENSEARCH_HOME=/graylog/opensearch
Environment=OPENSEARCH_PATH_CONF=/graylog/opensearch/config
ReadWritePaths=/var/log/opensearch
User=opensearch
Group=opensearch
WorkingDirectory=/graylog/opensearch
ExecStart=/graylog/opensearch/bin/opensearch
# Specifies the maximum file descriptor number that can be opened by this process
LimitNOFILE=65535
# Specifies the maximum number of processes
LimitNPROC=4096
# Specifies the maximum size of virtual memory
LimitAS=infinity
# Specifies the maximum file size
LimitFSIZE=infinity
# Disable timeout logic and wait until process is stopped
TimeoutStopSec=0
# SIGTERM signal is used to stop the Java process
KillSignal=SIGTERM
# Send the signal only to the JVM rather than its control group
KillMode=process
# Java process is never killed
SendSIGKILL=no
# When a JVM receives a SIGTERM signal it exits with code 143
SuccessExitStatus=143
# Allow a slow startup before the systemd notifier module kicks in to extend the timeout
TimeoutStartSec=180
[Install]
WantedBy=multi-user.target
</span><span class="no">EOF
</span></pre></table></code></div></div><h3 id="configuring-opensearch-for-graylog"><span class="mr-2">Configuring OpenSearch for Graylog</span><a href="#configuring-opensearch-for-graylog" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Open the pre-completed YAML file and update the following fields, remove pound characters as required. This configuration is modified from the recommendations set by Graylog as its a single-node deployment.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /graylog/opensearch/config/opensearch.yml

<span class="c"># Insert the below configuration</span>
cluster.name: graylog
node.name: <span class="k">${</span><span class="nv">HOSTNAME</span><span class="k">}</span>
path.data: /graylog/opensearch/data
path.logs: /var/log/opensearch
network.host: &lt;IP&gt;
http.port: 9200

<span class="c"># discovery.seed_hosts: </span>
<span class="c"># cluster.initial_master_nodes:</span>
discovery.type: single-node 
action.auto_create_index: <span class="nb">false
</span>plugins.security.disabled: <span class="nb">true</span>
</pre></table></code></div></div><ol><li>Specify initial and maximum JVM heap sizes to half of the host systems memory allocation. This can be increased post configuration of Graylog should you require more memory assigned. After setting the JVM heap sizes, specify the environment path for the setting.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>nano /graylog/opensearch/config/jvm.options

<span class="c"># These settings represent 8GB allocations</span>
<span class="nt">-Xms8g</span>
<span class="nt">-Xmx8g</span>

<span class="nb">export </span><span class="nv">OPENSEARCH_JAVA_HOME</span><span class="o">=</span>/graylog/opensearch/jdk
</pre></table></code></div></div><ol><li>Enable the system service to run upon system boot</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl daemon-reload
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>opensearch.service
<span class="nb">sudo </span>systemctl start opensearch.service
<span class="nb">sudo </span>systemctl status opensearch.service <span class="c"># Check that the service is active</span>
</pre></table></code></div></div><h3 id="installing-graylog"><span class="mr-2">Installing Graylog</span><a href="#installing-graylog" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Download and install the Graylog package from the legitimate repository. Once completed, the server components can be installed via the APT package.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>wget https://packages.graylog2.org/repo/packages/graylog-5.0-repository_latest.deb
<span class="nb">sudo </span>dpkg <span class="nt">-i</span> graylog-5.0-repository_latest.deb
<span class="nb">sudo </span>apt-get update <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt-get <span class="nb">install </span>graylog-server
<span class="nb">rm </span>graylog<span class="k">*</span> <span class="c"># clean up download</span>
</pre></table></code></div></div><h3 id="configuring-graylog"><span class="mr-2">Configuring Graylog</span><a href="#configuring-graylog" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ol><li>Graylog is configured using a YAML file within the <code class="language-plaintext highlighter-rouge">/etc/graylog/server/</code> directory and requires configuration in order to start. Initially, a root password hash using SHA2 is required. Make note of the password and hash as both are required to be entered into the configuration file. Note that the password must be a minimum of 16 characters.</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nb">echo</span> <span class="nt">-n</span> <span class="s2">"Enter Password: "</span> <span class="o">&amp;&amp;</span> <span class="nb">head</span> <span class="nt">-1</span> &lt;/dev/stdin | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\n'</span> | <span class="nb">sha256sum</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s2">" "</span> <span class="nt">-f1</span>

<span class="nb">sudo </span>nano /etc/graylog/server/server.conf

<span class="c"># Configure the details as required</span>
password_secret <span class="o">=</span> &lt;PASSWORD&gt; <span class="c"># Min 16 Characters (at least 64 Recommended)</span>
root_username <span class="o">=</span> &lt;USERNAME&gt;
root_password_sha2 <span class="o">=</span> &lt;ROOT PASSWORD HASH&gt; <span class="c"># Different to password_secret - memorize plain-text equivilent)</span>
http_bind_address <span class="o">=</span> &lt;IP&gt;:9000 <span class="c"># Set to host IP</span>
</pre></table></code></div></div><ol><li>Enable the system service to run upon system boot</ol><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>systemctl daemon-reload
<span class="nb">sudo </span>systemctl <span class="nb">enable </span>graylog-server.service
<span class="nb">sudo </span>systemctl start graylog-server.service
<span class="nb">sudo </span>systemctl status graylog-server.service <span class="c"># Check that the service is active</span>
</pre></table></code></div></div><ol><li>Graylog can now be access via web browser by navigating to <code class="language-plaintext highlighter-rouge">http://&lt;IP&gt;:9000</code></ol><h2 id="resources"><span class="mr-2">Resources</span><a href="#resources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li><a href="https://go2docs.graylog.org/5-0/downloading_and_installing_graylog/ubuntu_installation.html">Ubuntu installation (graylog.org)</a><li><a href="https://www.mongodb.com/docs/manual/tutorial/install-mongodb-on-ubuntu/#:~:text=Install%20MongoDB%20Community%20Edition%201%20Import%20the%20public,database.%20...%204%20Install%20the%20MongoDB%20packages.%20">Install MongoDB Community Edition on Ubuntu â€” MongoDB Manual</a><li><a href="https://www.webuters.com/elasticsearch-vs-opensearch-how-they-differ">Elasticsearch vs OpenSearch: How They Differ? - Webuters</a><li><a href="https://opensearch.org/docs/2.4/install-and-configure/install-opensearch/index/">Install OpenSearch - OpenSearch documentation</a><li><a href="https://go2docs.graylog.org/5-0/getting_in_log_data/getting_in_log_data.html">Sending in log data (graylog.org)</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/general-it-and-security/'>General IT and Security</a>, <a href='/categories/engineering/'>Engineering</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/graylog/" class="post-tag no-text-decoration" >graylog</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Installing+and+Configuring+Graylog+-+darkcybe&url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FInstalling_Graylog%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Installing+and+Configuring+Graylog+-+darkcybe&u=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FInstalling_Graylog%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FInstalling_Graylog%2F&text=Installing+and+Configuring+Graylog+-+darkcybe" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FInstalling_Graylog%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DFIR_Evidence_of_Account_Usage/">Evidence of Account Usage</a><li><a href="/posts/DFIR_Evidence_of_Execution/">Evidence of Execution</a><li><a href="/posts/Active_Directory/">Active Directory</a><li><a href="/posts/Command_and_Control/">Command and Control</a><li><a href="/posts/ETH_Overview/">Ethical Hacking Overview</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Installing_SIFT_Workstation/"><div class="card-body"> <em class="small" data-ts="1662904800" data-df="ll" > Sep 12, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Building SIFT Workstation on Ubuntu 20.04 LTS</h3><div class="text-muted small"><p> The good folks at SANS Institute have put together and maintain a pre-configured collection of tools to assist DFIR analysts in their war against the cyber baddies. If youâ€™ve taken one of SANS DFIR...</p></div></div></a></div><div class="card"> <a href="/posts/Installing_Wazuh/"><div class="card-body"> <em class="small" data-ts="1662991200" data-df="ll" > Sep 13, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Installing and Configuring Wazuh EDR</h3><div class="text-muted small"><p> Overview Wazuh is a security platform that provides unified XDR and SIEM protection for endpoints and cloud workloads. The solution is composed of a single universal agent and three central compon...</p></div></div></a></div><div class="card"> <a href="/posts/The_Hive_Install/"><div class="card-body"> <em class="small" data-ts="1662991200" data-df="ll" > Sep 13, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TheHive4, Cortex, and MISP Server Installation</h3><div class="text-muted small"><p> Overview â€œTheHive is a scalable 3-in-1 open source and free Security Incident Response Platform designed to make life easier for SOCs, CSIRTs, CERTs and any information security practitioner deali...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Awesome-Github/" class="btn btn-outline-primary" prompt="Older"><p>Awesome GitHub Links</p></a><div class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></div></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> Â© 2023 <a href="https://twitter.com/darkcybe">darkcybe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QFH2BQ5ZG5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QFH2BQ5ZG5'); }); </script>
