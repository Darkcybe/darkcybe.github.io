<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Evidence of Execution" /><meta property="og:locale" content="en" /><meta name="description" content="Techniques that can be used to discover evidence in support of program execution post-breach or during an attack." /><meta property="og:description" content="Techniques that can be used to discover evidence in support of program execution post-breach or during an attack." /><link rel="canonical" href="https://darkcybe.github.io/posts/DFIR_Evidence_of_Execution/" /><meta property="og:url" content="https://darkcybe.github.io/posts/DFIR_Evidence_of_Execution/" /><meta property="og:site_name" content="darkcybe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-11T00:00:00+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Evidence of Execution" /><meta name="twitter:site" content="@darkcybe" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-19T21:43:22+11:00","datePublished":"2022-09-11T00:00:00+10:00","description":"Techniques that can be used to discover evidence in support of program execution post-breach or during an attack.","headline":"Evidence of Execution","mainEntityOfPage":{"@type":"WebPage","@id":"https://darkcybe.github.io/posts/DFIR_Evidence_of_Execution/"},"url":"https://darkcybe.github.io/posts/DFIR_Evidence_of_Execution/"}</script><title>Evidence of Execution | darkcybe</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="darkcybe"><meta name="application-name" content="darkcybe"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/darkcybe.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">darkcybe</a></div><div class="site-subtitle font-italic">This is the security blog you've been looking for</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/darkcybe" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/darkcybe" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://discordapp.com/users/darkcybe#4349" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Evidence of Execution</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Evidence of Execution</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1662818400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 11, 2022 </em> </span> <span> Updated <em class="" data-ts="1671446602" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 19, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/darkcybe">darkcybe</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2081 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>Techniques that can be used to discover evidence in support of program execution post-breach or during an attack.</p><h2 id="windows"><span class="mr-2">Windows</span><a href="#windows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="activitiescachedb-windows-timeline"><span class="mr-2">ActivitiesCache.db (Windows Timeline)</span><a href="#activitiescachedb-windows-timeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Windows 10 introduced a background feature that records recently used applications and accessed files over a 30 day duration in a “timeline” accessible via the “WIN+TAB” key. The data is recorded in a SQLite database. Windows 11 removed the “WIN+TAB” functionality, however the ActivitiesCache.db still remains.</p><p>Research identified that Windows Server 2016 also maintains an ActivitiesCache.db file, however <code class="language-plaintext highlighter-rouge">ActivityOperation</code>, <code class="language-plaintext highlighter-rouge">Activity_PackageId</code>, and <code class="language-plaintext highlighter-rouge">Activity</code> entries were not recorded.</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Windows<th style="text-align: center">XP<th style="text-align: center">7<th style="text-align: center">8<th style="text-align: center">10<th style="text-align: center">11<tbody><tr><td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Server<th style="text-align: center">2003R2<th style="text-align: center">2008R2<th style="text-align: center">2012R2<th style="text-align: center">2016<th style="text-align: center">2019<th style="text-align: center">2022<tbody><tr><td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><h4 id="location"><span class="mr-2">Location</span><a href="#location" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># Local Account
C:\Users\%PROFILE%\AppData\Local\ConnectedDevicesPlatform\L.%PROFILE%\ActivitiesCache.db

# Online Account
C:\Users\%PROFILE%\AppData\Local\ConnectedDevicesPlatform\%CID%\ActivitiesCache.db
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Files within the <code class="language-plaintext highlighter-rouge">L.%USERPROFILE%</code> directory.<ul><li><strong>ActivitiesCache.db:</strong> SQLite Database<li><strong>ActivitiesCache.db-wal:</strong> ‘Write ahead’ Log (Holds activity events prior to pushing them to the database - Reboot system to write to database)<li><strong>ActivitiesCache.db-shm:</strong> ‘Shared memory’ file</ul><li>The database contains evidence such as;<ul><li><code class="language-plaintext highlighter-rouge">ActivityType</code>: Activity performed (ExecuteOpen, InFocus, CopyPaste, etc)<li><code class="language-plaintext highlighter-rouge">Executable</code>: Parent application used to open or execute file<li><code class="language-plaintext highlighter-rouge">DisplayText</code>: Title of file or application<li><code class="language-plaintext highlighter-rouge">ContentInfo</code>: Possible content information, not always present<li>Timestamps: <code class="language-plaintext highlighter-rouge">StartTime</code>, <code class="language-plaintext highlighter-rouge">EndTime</code>, and <code class="language-plaintext highlighter-rouge">Duration</code> are some of the most interesting recorded events.</ul></ul><h4 id="tools"><span class="mr-2">Tools</span><a href="#tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Execution_WxTcmd/">Darkcybe - WxTCmd</a><li><a href="https://tzworks.com/prototype_page.php?proto_id=41">ActivitiesCache Parser – Requires License</a><li><a href="https://github.com/log2timeline/plaso">Log2timeline (windows-timeline parser)</a></ul><h4 id="sources"><span class="mr-2">Sources</span><a href="#sources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://kacos2000.github.io/WindowsTimeline/">Kacos2000 - Windows Timeline</a><li><a href="https://support.microsoft.com/en-us/windows/-windows-activity-history-and-your-privacy-2b279964-44ec-8c2f-e0c2-6779b07d2cbd">Microsoft - Windows Activity History and Your Privacy</a><li><a href="https://salt4n6.com/2018/05/03/windows-10-timeline-forensic-artefacts/">Salt 4N6 - Windows 10 Timeline Forensic Artifacts</a></ul><h3 id="amcachehve"><span class="mr-2">AmCache.hve</span><a href="#amcachehve" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>ProgramDataUpdater (a task associated with the Application Experience Service) uses the registry file Amcache.hve to store data during process creation. Details of program installation and execution are stored.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th style="text-align: center">XP<th style="text-align: center">7<th style="text-align: center">8<th style="text-align: center">10<th style="text-align: center">11<tbody><tr><td> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th>Server<th style="text-align: center">2003R2<th style="text-align: center">2008R2<th style="text-align: center">2012R2<th style="text-align: center">2016<th style="text-align: center">2019<th style="text-align: center">2022<tbody><tr><td> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><h4 id="location-1"><span class="mr-2">Location</span><a href="#location-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C:\Windows\AppCompat\Programs\Amcache.hve
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-1"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Amcache.hve - Keys = <code class="language-plaintext highlighter-rouge">Amcache.hve\Root\File\{Volume GUID}\#######</code><li>Entry for every executable run, full path information, files <code class="language-plaintext highlighter-rouge">$StandardInfo</code> Last Modification Time, and Disk Volume the executable was run from.<li>First Run Time = Last Modification Time of key<li>SHA1 hash of executable also contained in the key.</ul><h4 id="tools-1"><span class="mr-2">Tools</span><a href="#tools-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Execution_AmCacheParser/">Darkcybe - AmCache Parser</a><li><a href="https://powerforensics.readthedocs.io/en/latest/modulehelp/Get-ForensicAmcache/">Get-ForensicAmcache)</a><li><a href="https://github.com/log2timeline/plaso">Log2timeline (amcache parser)</a><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Toolkits_RegistryExplorer/#loading-a-hosts-registry-via-registry-explorer">Darkcybe - Registry Explorer</a></ul><h4 id="sources-1"><span class="mr-2">Sources</span><a href="#sources-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.andreafortuna.org/2017/10/16/amcache-and-shimcache-in-forensic-analysis/">Andrea Fortuna - AmCache and Shimcache in Forensic Analysis</a></ul><h3 id="background-activity-bam-and-desktop-activity-moderator-dam"><span class="mr-2">Background Activity (BAM) and Desktop Activity Moderator (DAM)</span><a href="#background-activity-bam-and-desktop-activity-moderator-dam" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Windows BAM and DAM are updated when Windows boots and controls the activity of background applications and is found on all Windows devices and is managed by <code class="language-plaintext highlighter-rouge">C:\Windows\System32\drivers\bam.sys</code>. DAM is only populated with details of applications on Windows Tablets and Mobile devices although the empty registry key will be present on host devices.</p><p>BAM and DAM entries are only stored during a session, with events clearing upon reboot or when entries have been present in the key for over 7 days. Another item to consider is that executables hosted on removable media are not recorded in the BAM or DAM.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th style="text-align: center">XP<th style="text-align: center">7<th style="text-align: center">8<th style="text-align: center">10<th style="text-align: center">11<tbody><tr><td> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th>Server<th style="text-align: center">2003R2<th style="text-align: center">2008R2<th style="text-align: center">2012R2<th style="text-align: center">2016<th style="text-align: center">2019<th style="text-align: center">2022<tbody><tr><td> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><h4 id="location-2"><span class="mr-2">Location</span><a href="#location-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># BAM
HKLM\System\CurrentControlSet\Services\bam\state\UserSettings\{SID}

# DAM
HKLM\System\CurrentControlSet\Services\dam\state\UserSettings\{SID}
</pre></table></code></div></div><blockquote class="prompt-info"><div><p><code class="language-plaintext highlighter-rouge">CurrentControlSet</code> may be substituted by <code class="language-plaintext highlighter-rouge">ControlSet001</code> or <code class="language-plaintext highlighter-rouge">ControlSet002</code>. The <code class="language-plaintext highlighter-rouge">ControlSet00x</code> are alternating backups of the <code class="language-plaintext highlighter-rouge">CurrentControlSet</code>.</p></div></blockquote><h4 id="interpretation-and-investigative-notes-2"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Provides full path of the executable file that was run on the system and the last time date time group of execution.</p><h4 id="tools-2"><span class="mr-2">Tools</span><a href="#tools-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Toolkits_RegistryExplorer/#Parsing-the-BAM/DAM-for-Evidence-of-Execution">Darkcybe - Registry Explorer</a></ul><h4 id="sources-2"><span class="mr-2">Sources</span><a href="#sources-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.linkedin.com/pulse/alternative-prefetch-bam-costas-katsavounidis/">Costas K - An Alternative to Prefetch -&gt; BAM</a><li><a href="https://dfir.ru/2020/04/08/bam-internals/">DFIR.ru - BAM Internals</a></ul><h3 id="jump-list"><span class="mr-2">Jump List</span><a href="#jump-list" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The Windows task bar (Jump List) is engineered to allow users to “jump” or access items they have frequently or recently. This can include files, applications, and directories to name the major items of significance for forensic investigations.</p><p>The data stored in the AutomaticDestinations directory contains a unique file for each application prepended with a unique Application ID (AppID) correlated to the associated application, such as the following example which depicts the AppID of Windows Explorer 8.1: <code class="language-plaintext highlighter-rouge">f01b4d95cf55d32a.automaticDestinations-ms</code>.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th style="text-align: center">XP<th style="text-align: center">7<th style="text-align: center">8<th style="text-align: center">10<th style="text-align: center">11<tbody><tr><td> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th>Server<th style="text-align: center">2003R2<th style="text-align: center">2008R2<th style="text-align: center">2012R2<th style="text-align: center">2016<th style="text-align: center">2019<th style="text-align: center">2022<tbody><tr><td> <td style="text-align: center"> <td style="text-align: center"> <td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i><td style="text-align: center"><i class="fa fa-check-circle"></i></table></div><h4 id="location-3"><span class="mr-2">Location</span><a href="#location-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C:%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Recent\AutomaticDestinations
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-3"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>The Jump List files contain information relating to program execution times, execution count and local file paths of the application being investigated.<li>AppIDs are universally used across Windows and Server versions from 2007/2012 onwards. Correlations for common applications can be found <a href="https://forensicswiki.xyz/wiki/index.php?title=List_of_Jump_List_IDs">here</a>.</ul><h4 id="tools-3"><span class="mr-2">Tools</span><a href="#tools-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Execution_JLE/">Darkcybe - JumpListExplorer (JLE)</a><li><a href="https://tzworks.com/prototype_page.php?proto_id=20">Windows Jump List Parser – Requires License</a></ul><h4 id="sources-3"><span class="mr-2">Sources</span><a href="#sources-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://superuser.com/questions/496059/what-is-a-jump-list-in-windows">Superuser - What is a Jump List in Windows?</a><li><a href="https://dfir.pubpub.org/pub/wfuxlu9v/release/1">DFRWS - Windows 10 Jump Lists and Link File Artifacts - Saved, Copied and Moved</a></ul><h3 id="lastvisitedmru"><span class="mr-2">LastVisitedMRU</span><a href="#lastvisitedmru" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The LastVisitedMRU is responsible for tracking specific executables used by an application to open files documented under the OpenSaveMRU registry key. In addition, each value tracks the directory location for the last file that was accessed by that application. The information can provide forensic insight into an applications execution and file and folder interaction.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th>XP<th>7<th>8<th>10<th>11<th> <tbody><tr><td> <td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td> </table></div><div class="table-wrapper"><table><thead><tr><th>Server<th>2003R2<th>2008R2<th>2012R2<th>2016<th>2019<th>2022<tbody><tr><td> <td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i></table></div><h4 id="location-4"><span class="mr-2">Location</span><a href="#location-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre># WINDOWS: XP
# SERVER: 2003
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDIg32\LastVisitedMRU

# WINDOWS: 7+
# SERVER: 2008+
NTUSER.DAT\Software\Microsoft\Windows\CurrentVersion\Explorer\ComDIg32\LastVisitedPidlMRU
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>The NTUSER.DAT file is unique for each user on the target host.</p></div></blockquote><h4 id="interpretation-and-investigative-notes-4"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Tracks the application executables used to open files in OpenSaveMRU and the last file path used, for example: Notepad.exe was last run under the <code class="language-plaintext highlighter-rouge">C:\%USERPROFILE%\Desktop</code> directory.</p><h4 id="tools-4"><span class="mr-2">Tools</span><a href="#tools-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Toolkits_RegistryExplorer/#Parsing-the-LastVisitedMRU-for-Evidence-of-Execution">Darkcybe - Registry Explorer</a><li><a href="https://www.forensafe.com/free.html">ArtiFast Lite 4</a></ul><h4 id="sources-4"><span class="mr-2">Sources</span><a href="#sources-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.sans.org/blog/opensavemru-and-lastvisitedmru/">SANS - OpenSaveMRU and LastVisitedMRU</a><li><a href="https://www.forensafe.com/blogs/lastvisitedmru.html">Forensafe - LastVisitedMRU</a></ul><h3 id="prefetch"><span class="mr-2">Prefetch</span><a href="#prefetch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Increases performance of a system by pre-loading code pages of commonly used applications. Cache Manager monitors all files and directories referenced for each application or process and maps them into a .pf file. Utilized to know an application was executed on a system.</p><ul><li>Limited to 128 files on XP and Windows 7<li>Limited to 1024 files on Windows 8<li><code class="language-plaintext highlighter-rouge">&lt;EXE_NAME&gt;-&lt;HASH&gt;.pf</code></ul><div class="table-wrapper"><table><thead><tr><th>Windows<th>XP<th>7<th>8<th>10<th>11<tbody><tr><td> <td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th>Server<th>2003R2<th>2008R2<th>2012R2<th>2016<th>2019<th>2022<tbody><tr><td> <td><i class="fa fa-check-circle"></i> *<td><i class="fa fa-check-circle"></i> *<td><i class="fa fa-check-circle"></i> *<td><i class="fa fa-check-circle"></i> *<td><i class="fa fa-check-circle"></i> *<td> </table></div><blockquote><p>Although prefetch is available on Windows Servers, it is disabled by default. To enable Prefetch on Windows Servers (I was unable to get this working on Windows Server 2022), the following steps can be taken. However, keep in mind that it will need to be enable prior to any nefarious activities occurring and will not provide retrospective artifacts. Prefetch can also be disabled by default when the system detected an SSD being used, enabling can be configured by the same.</p><ol><li>Update or create the <code class="language-plaintext highlighter-rouge">EnablePrefetcher</code> registry key in <code class="language-plaintext highlighter-rouge">HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Session Manager\Memory Management\PrefetchParameters</code><li>Set the <code class="language-plaintext highlighter-rouge">EnablePrefetcher</code> key value: <code class="language-plaintext highlighter-rouge">0</code> = Disabled, <code class="language-plaintext highlighter-rouge">1</code> = Application launch prefetching enabled, <code class="language-plaintext highlighter-rouge">2</code> = Boot prefetching enabled, <code class="language-plaintext highlighter-rouge">2</code> = Application launch and boot prefetching enabled.</ol></blockquote><h4 id="location-5"><span class="mr-2">Location</span><a href="#location-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>C:\Windows\Prefetch
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-5"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Each .pf file will include last time of execution, number of times run, and device and file handles used by the program.<li>Date/Time file by that name and path was first executed<ul><li>Creation Date of .pf file (-10 seconds)</ul><li>Date/Time file by that name and path was last executed<ul><li>Windows 8+ will contain last 8 times of execution.</ul></ul><h4 id="tools-5"><span class="mr-2">Tools</span><a href="#tools-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Execution_PeCmd/">Darkcybe - PeCmd</a><li><a href="https://tzworks.com/prototype_page.php?proto_id=1">Windows Prefetch Parser - Requires License</a></ul><h4 id="sources-5"><span class="mr-2">Sources</span><a href="#sources-5" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.geeksforgeeks.org/prefetch-files-in-windows/">Geeks for Geeks - Prefetch Files in Windows</a><li><a href="https://learn.microsoft.com/en-us/previous-versions/windows/embedded/ms940847(v=winembedded.5)?redirectedfrom=MSDN">Microsoft - Disabling/Enabling Prefetch</a></ul><h3 id="recentapps"><span class="mr-2">RecentApps</span><a href="#recentapps" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Windows 10 tracked Program execution via the RecentApps registry key for particular versions.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th>XP<th>7<th>8<th>10<th>11<tbody><tr><td> <td> <td> <td> <td><i class="fa fa-check-circle"></i><td> </table></div><blockquote><p>Only Microsoft Windows 10 versions V1607-1709 appear to populate the RecentApps registry key.</p></blockquote><div class="table-wrapper"><table><thead><tr><th>Server<th>2003R2<th>2008R2<th>2012R2<th>2016<th>2019<th>2022<tbody><tr><td> <td> <td> <td> <td> <td> <td> </table></div><h4 id="location-6"><span class="mr-2">Location</span><a href="#location-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>NTUSER.DAT\Software\Microsoft\Windows\Current Version\Search\RecentApps
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-6"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>Each GUID key points to a recent application.<ul><li><code class="language-plaintext highlighter-rouge">AppID</code> = Name of Application<li><code class="language-plaintext highlighter-rouge">LastAccessTime</code> = Last execution time in UTC<li><code class="language-plaintext highlighter-rouge">LaunchCount</code> = Number of times executed</ul></ul><h4 id="tools-6"><span class="mr-2">Tools</span><a href="#tools-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.sans.org/tools/registry-explorer/">Registry Explorer (RECmd)</a></ul><h4 id="sources-6"><span class="mr-2">Sources</span><a href="#sources-6" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://df-stream.com/2017/10/recentapps/">Df-Stream - Recent Apps</a><li><a href="https://thinkdfir.com/2020/10/23/when-did-recentapps-go/">Think DFIR - When Did RecentApps Go?</a></ul><h3 id="shimcache-appcompatcache"><span class="mr-2">Shimcache (AppCompatCache)</span><a href="#shimcache-appcompatcache" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The Shimcache (also known as AppCompatCache) allows applications to call properties from earlier Windows versions, avoiding the need to rewrite an application when the host operating system is upgraded. When an application launches, it checks for compatibility and creates a Shimcache item that maintains the executable’s last modification date, file path, and file size.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th>XP<th>7<th>8<th>10<th>11<tbody><tr><td> <td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th>Server<th>2003R2<th>2008R2<th>2012R2<th>2016<th>2019<th>2022<tbody><tr><td> <td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i></table></div><h4 id="location-7"><span class="mr-2">Location</span><a href="#location-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># WINDOWS: XP
SYSTEM\CurrentControlSet\Control\SessionManager\AppCompatability

# WINDOWS: 7+
SYSTEM\CurrentControlSet\Control\Session Manager\AppCompatCache
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-7"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>This key contains any executable that runs on the Windows system. This key can be used to determine which computers malware or other applications of interest was executed on. Furthermore, depending on the interpretation of time-based data, you may be able to ascertain the last time the system was executed or that activity occurred.</p><ul><li>Windows XP has a maximum of 96 entries, with the <code class="language-plaintext highlighter-rouge">LastUpdateTime</code> field being changed when the executable is run.<li>Windows 7 and later systems have a maximum of 1024 entries., However the <code class="language-plaintext highlighter-rouge">LastUpdateTime</code> field does not exist.</ul><p>The registry key itself is not displayed in an easy to read format if utilizing the native <code class="language-plaintext highlighter-rouge">regedit.exe</code> tool, therefore parsing with a third party tool is a requirement to analyze the data.</p><blockquote class="prompt-info"><div><p>Entries do not always indicate execution as they may be shimmed prior to execution when first dropped on disk. Execution should be be proven via multiple methods where able.</p></div></blockquote><h4 id="tools-7"><span class="mr-2">Tools</span><a href="#tools-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/DFIR_Tools_Toolkits_RegistryExplorer/#Parsing-the-ShimCache-for-Evidence-of-Execution">Darkcybe - Registry Explorer</a><li><a href="https://darkcybe.github.io/posts/AppCompatCacheParser">Darkcybe - AppCompatCacheParser</a><li><a href="https://tzworks.com/prototype_page.php?proto_id=29">AppCompatibilityCache Utility - Requires License</a></ul><h4 id="sources-7"><span class="mr-2">Sources</span><a href="#sources-7" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://chrismenne.com/windows-shimcache-analysis/">Chris Menne - Windows Shimcache Analysis</a></ul><h3 id="system-resource-usage-monitor-srum"><span class="mr-2">System Resource Usage Monitor (SRUM)</span><a href="#system-resource-usage-monitor-srum" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The System Resource Usage Monitor (SRUM) records 30 to 60 days of historical system performance, including details in support of applications run, user account responsible for each, and application and bytes sent/received per application per hour. A lot of this information assists in populating the ‘App History’ tab on the Task Manager.</p><div class="table-wrapper"><table><thead><tr><th>Windows<th>XP<th>7<th>8<th>10<th>11<tbody><tr><td> <td> <td> <td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i><td><i class="fa fa-check-circle"></i></table></div><div class="table-wrapper"><table><thead><tr><th>Server<th>2003R2<th>2008R2<th>2012R2<th>2016<th>2019<th>2022<tbody><tr><td> <td> <td> <td> <td> <td> <td><i class="fa fa-check-circle"></i></table></div><h4 id="location-8"><span class="mr-2">Location</span><a href="#location-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># Registry - Artifacts cannot be parsed from the registry location
SOFTWARE\Microsoft\WindowsNT\CurrentVersion\SRUM\Extensions{d10ca2fe-xxxx-xxxx-xxxx-xxxxxxxxxxxx}

# Filepath
C:\Windows\System32\SRU\
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-8"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>SRUM Extension GUIDs<ul><li><code class="language-plaintext highlighter-rouge">973F5D5C-1D90-4944-BE8E-24B94231A174</code> - Windows Network Data Usage Monitor<li><code class="language-plaintext highlighter-rouge">D10CA2FE-6FCF-4F6D-848E-B2E99266FA86</code> - Push Notifications (WPN) Provider<li><code class="language-plaintext highlighter-rouge">D10CA2FE-6FCF-4F6D-848E-B2E99266FA89</code> - Application Resource Usage Provider<li><code class="language-plaintext highlighter-rouge">DD6636C4-8929-4683-974E-22C046A43763</code> - Windows Network Connectivity Usage Monitor<li><code class="language-plaintext highlighter-rouge">FEE4E14F-02A9-4550-B5CE-5FA2DA202E37</code> - Energy Usage Provider</ul></ul><h4 id="tools-8"><span class="mr-2">Tools</span><a href="#tools-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://darkcybe.github.io/posts/SrumECmd">Darkcybe - SrumECmd Guide</a><li><a href="https://github.com/MarkBaggett/srum-dump">SRUM Dump</a><li><a href="https://www.forensafe.com/free.html">Forensafe</a></ul><h4 id="sources-8"><span class="mr-2">Sources</span><a href="#sources-8" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://velociraptor.velocidex.com/digging-into-the-system-resource-usage-monitor-srum-afbadb1a375">Velociraptor - Digging Into the System Resource Usage Monitor (SRUM)</a><li><a href="https://forensafe.com/blogs/srudb.html">Forensafe - SRUM</a></ul><h3 id="userassist"><span class="mr-2">UserAssist</span><a href="#userassist" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>GUI-based programs launched from the desktop are tracked in the launcher on a windows system</p><p><strong>WIN:</strong> XP, 7, 8, 10, 11<br /> <strong>SRV:</strong> NULL</p><h4 id="location-9"><span class="mr-2">Location</span><a href="#location-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>HKEY_USERS{SID}\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist{GUID}\Count

HKEY_CURRENT_USER\Software\Microsoft\Windows\Currentversion\Explorer\UserAssist{GUID}\Count
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-9"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li>All values are ROT-13 Encoded<ul><li><code class="language-plaintext highlighter-rouge">.RKR</code> = .exe<li><code class="language-plaintext highlighter-rouge">.YAX</code> = .lnk</ul><li>GUID for XP<ul><li><code class="language-plaintext highlighter-rouge">75048700</code> - Active Desktop</ul><li>GUID for Win7/8/10/11<ul><li><code class="language-plaintext highlighter-rouge">CEBFF5CD</code> - Executable File Execution<li><code class="language-plaintext highlighter-rouge">F4E57C4B</code> - Shortcut File Execution</ul></ul><h4 id="tools-9"><span class="mr-2">Tools</span><a href="#tools-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="http://www.nirsoft.net/utils/userassist_view.html">UserAssist View</a><li><a href="https://www.sans.org/tools/registry-explorer/">Registry Explorer (RECmd)</a><li><a href="https://github.com/EricZimmerman/RegistryPlugins">RECmd - Registry Plugins</a></ul><h4 id="sources-9"><span class="mr-2">Sources</span><a href="#sources-9" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.aldeid.com/wiki/Windows-userassist-keys">Aldeid - Windows UserAssist Keys</a><li><a href="https://blog.didierstevens.com/programs/userassist/">Didier Stevens - UserAssist</a></ul><h3 id="powershell"><span class="mr-2">PowerShell</span><a href="#powershell" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>These events can be useful for tracking the use of PowerShell on a device, including the specific cmdlets, scripts, and providers that are being invoked. By analyzing these events, you can get a sense of which users are using PowerShell, and what actions they are performing.</p><p><strong>WIN:</strong> XP, 7, 8, 10, 11<br /> <strong>SRV:</strong> NULL</p><h4 id="location-10"><span class="mr-2">Location</span><a href="#location-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-10"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="table-wrapper"><table><thead><tr><th>Event Log<th>Event ID<th>Description<th>Details Recorded<tbody><tr><td>PowerShell.evtx<td>4103<td>A cmdlet was invoked.<td>The name of the cmdlet, the parameters passed to the cmdlet, and the security identifier (SID) of the user who invoked the cmdlet.<tr><td>PowerShell.evtx<td>4104<td>A script was executed.<td>The name and path of the script, the parameters passed to the script, and the security identifier (SID) of the user who executed the script.<tr><td>PowerShell.evtx<td>4105<td>A script block was invoked.<td>The script block that was invoked, the parameters passed to the script block, and the security identifier (SID) of the user who invoked the script block.<tr><td>PowerShell.evtx<td>4106<td>A provider was loaded.<td>The name of the provider that was loaded, the security identifier (SID) of the user who loaded the provider, and the logon ID.<tr><td>PowerShell.evtx<td>4107<td>A provider was unloaded.<td>The name of the provider that was unloaded, the security identifier (SID) of the user who unloaded the provider, and the logon ID.<tr><td>PowerShell.evtx<td>4108<td>A provider was invoked.<td>The name of the provider that was invoked, the security identifier (SID) of the user who invoked the provider, and the logon ID.<tr><td>PowerShell.evtx<td>4109<td>A provider was refused.<td>The name of the provider that was refused, the security identifier (SID) of the user who attempted to load the provider, and the logon ID.</table></div><h4 id="tools-10"><span class="mr-2">Tools</span><a href="#tools-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>-</p><h4 id="sources-10"><span class="mr-2">Sources</span><a href="#sources-10" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dfir/'>DFIR</a>, <a href='/categories/evidence-artifacts/'>Evidence Artifacts</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/userassist/" class="post-tag no-text-decoration" >userassist</a> <a href="/tags/shimcache/" class="post-tag no-text-decoration" >shimcache</a> <a href="/tags/appcompatcache/" class="post-tag no-text-decoration" >appcompatcache</a> <a href="/tags/amcache/" class="post-tag no-text-decoration" >amcache</a> <a href="/tags/lastvisitedmru/" class="post-tag no-text-decoration" >lastvisitedmru</a> <a href="/tags/ntuser-dat/" class="post-tag no-text-decoration" >ntuser.dat</a> <a href="/tags/activitiescache/" class="post-tag no-text-decoration" >activitiescache</a> <a href="/tags/recentapps/" class="post-tag no-text-decoration" >recentapps</a> <a href="/tags/jump-list/" class="post-tag no-text-decoration" >jump list</a> <a href="/tags/automaticdestinations/" class="post-tag no-text-decoration" >automaticdestinations</a> <a href="/tags/srum/" class="post-tag no-text-decoration" >srum</a> <a href="/tags/prefetch/" class="post-tag no-text-decoration" >prefetch</a> <a href="/tags/bam/" class="post-tag no-text-decoration" >bam</a> <a href="/tags/dam/" class="post-tag no-text-decoration" >dam</a> <a href="/tags/execution-ta0002/" class="post-tag no-text-decoration" >execution (TA0002)</a> <a href="/tags/registry/" class="post-tag no-text-decoration" >registry</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Evidence+of+Execution+-+darkcybe&url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Execution%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Evidence+of+Execution+-+darkcybe&u=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Execution%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Execution%2F&text=Evidence+of+Execution+-+darkcybe" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Execution%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DFIR_Evidence_of_Account_Usage/">Evidence of Account Usage</a><li><a href="/posts/DFIR_Evidence_of_Execution/">Evidence of Execution</a><li><a href="/posts/Active_Directory/">Active Directory</a><li><a href="/posts/Command_and_Control/">Command and Control</a><li><a href="/posts/ETH_Overview/">Ethical Hacking Overview</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/DFIR_Tools_Toolkits_RegistryExplorer/"><div class="card-body"> <em class="small" data-ts="1663682400" data-df="ll" > Sep 21, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Registry Explorer</h3><div class="text-muted small"><p> Overview Registry Explorer allows Windows registry hives to be interrogated and parsed for a wide variety of forensic artifacts. The tool comes in two versions, a GUI and a commandline interface. ...</p></div></div></a></div><div class="card"> <a href="/posts/DFIR_Evidence_of_File_and_Folder_Interaction/"><div class="card-body"> <em class="small" data-ts="1662818400" data-df="ll" > Sep 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Evidence of File and Folder Interaction</h3><div class="text-muted small"><p> Techniques that can be used to discover evidence in support of an attackers interaction with files and folders such as search, deletion and opening post-breach. Windows XP Search (ACMRU) A wide v...</p></div></div></a></div><div class="card"> <a href="/posts/DFIR_Tools_Execution_JLE/"><div class="card-body"> <em class="small" data-ts="1663855200" data-df="ll" > Sep 23, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JumpListExplorer (JLE)</h3><div class="text-muted small"><p> Overview The JumpListExplorer (JLE) is a tool that parsers Windows AutomaticDestinations files to provide information relating to application execution. Results are recorded per application Id (App...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/DFIR_Evidence_of_Download/" class="btn btn-outline-primary" prompt="Older"><p>Evidence of Download</p></a> <a href="/posts/DFIR_Evidence_of_External_Device_Activitity/" class="btn btn-outline-primary" prompt="Newer"><p>Evidence of External Device Activity</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/darkcybe">darkcybe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QFH2BQ5ZG5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QFH2BQ5ZG5'); }); </script>
