<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Evidence of Account Usage" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://darkcybe.github.io/posts/DFIR_Evidence_of_Account_Usage/" /><meta property="og:url" content="https://darkcybe.github.io/posts/DFIR_Evidence_of_Account_Usage/" /><meta property="og:site_name" content="darkcybe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-11T00:00:00+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Evidence of Account Usage" /><meta name="twitter:site" content="@darkcybe" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-12-19T21:43:22+11:00","datePublished":"2022-09-11T00:00:00+10:00","description":"Overview","headline":"Evidence of Account Usage","mainEntityOfPage":{"@type":"WebPage","@id":"https://darkcybe.github.io/posts/DFIR_Evidence_of_Account_Usage/"},"url":"https://darkcybe.github.io/posts/DFIR_Evidence_of_Account_Usage/"}</script><title>Evidence of Account Usage | darkcybe</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="darkcybe"><meta name="application-name" content="darkcybe"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/darkcybe.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">darkcybe</a></div><div class="site-subtitle font-italic">This is the security blog you've been looking for</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/darkcybe" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/darkcybe" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://discordapp.com/users/darkcybe#4349" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Evidence of Account Usage</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Evidence of Account Usage</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1662818400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Sep 11, 2022 </em> </span> <span> Updated <em class="" data-ts="1671446602" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Dec 19, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/darkcybe">darkcybe</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2029 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><h2 id="overview"><span class="mr-2">Overview</span><a href="#overview" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Forensic evidence of account usage refers to the evidence that can be collected and analyzed to determine who used a particular account, when the account was accessed, and what actions were taken while the account was in use. This type of evidence can be useful in a variety of situations, including investigations into cyber crimes, unauthorized access to systems or data, and employee misconduct.</p><p>There are several types of forensic evidence that can be used to identify account usage:</p><ol><li><strong>Log files:</strong> Log files, such as system logs, network logs, and application logs, can contain information about who accessed a particular account and when. This information can be analyzed to determine the actions that were taken while the account was in use.<li><strong>System artifacts:</strong> System artifacts, such as registry keys, system files, and application data, can contain information about the accounts that have been used on a particular system. This information can be analyzed to determine the actions that were taken while the account was in use.<li><strong>Network traffic:</strong> Network traffic, such as packets and traffic logs, can contain information about the accounts that were used to access systems or data over the network. This information can be analyzed to determine the actions that were taken while the account was in use.<li><strong>User artifacts:</strong> User artifacts, such as files and documents, can contain information about the accounts that were used to create or modify them. This information can be analyzed to determine the actions that were taken while the account was in use.</ol><h2 id="windows"><span class="mr-2">Windows</span><a href="#windows" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="last-login-and-last-password-change"><span class="mr-2">Last Login and Last Password Change</span><a href="#last-login-and-last-password-change" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The “Last Login” and “Last Password Change” artifacts refer to the time stamps that are recorded when a user logs into an account or changes their password. These artifacts can be useful in forensic investigations to determine the usage of an account and to identify any suspicious activity.</p><p>The “Last Login” artifact is a time stamp that is recorded when a user logs into an account. This artifact can be useful in determining the last time that the account was accessed and can help to identify any suspicious activity.</p><p>The “Last Password Change” artifact is a time stamp that is recorded when a user changes their password. This artifact can be useful in determining the last time that the password for the account was changed and can help to identify any suspicious activity.</p><p><strong>WIN:</strong> XP+ <br /> <strong>SRV:</strong> NULL</p><h4 id="location"><span class="mr-2">Location</span><a href="#location" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre># WINDOWS XP+
C:\windows\System32\config\SAM

SAM\Domains\Account\Users
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>The System32\config\SAM file is a system file that is used to store information about user accounts on a Windows system. This file can be a useful source of forensic evidence in investigations into cyber crimes, unauthorized access to systems or data, and employee misconduct.</p><p>The SAM file contains several types of forensic evidence that can be useful in investigations, including:</p><ol><li><strong>User account information:</strong> The SAM file contains information about the user accounts that have been created on the system, including the user names, account types, and security identifiers (SIDs). This information can be useful in determining who has accessed the system and what actions they have taken.<li><strong>Hashed passwords:</strong> The SAM file contains hashed versions of the passwords for the user accounts.<li><strong>Last login and password change timestamps:</strong> The SAM file contains time stamps for the last time that each user account was accessed and the last time that the password was changed. These timestamps can be useful in determining the usage of the accounts and identifying any suspicious activity.</ol><h4 id="tools"><span class="mr-2">Tools</span><a href="#tools" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.sans.org/tools/registry-explorer/">Registry Explorer (RECmd)</a><li><a href="https://github.com/keydet89/RegRipper3.0">Reg Ripper</a></ul><h4 id="sources"><span class="mr-2">Sources</span><a href="#sources" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://boncaldoforensics.wordpress.com/2018/08/01/4n6-quick-01-windows-users-list-login-count/">Boncaldo Forensics - 4N6 Quick 01 Windows Users List Login Count</a></ul><h3 id="remote-desktop-protocol-rdp-usage---securityevtx"><span class="mr-2">Remote Desktop Protocol (RDP) Usage - Security.evtx</span><a href="#remote-desktop-protocol-rdp-usage---securityevtx" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The security.evtx event log is a system log that is used to record security-related events on a Windows system. This log can contain forensic evidence related to the usage of the Remote Desktop Protocol (RDP), which is a network protocol that allows users to remotely connect to and control another computer.</p><p>The security.evtx event log can contain several types of forensic evidence related to RDP usage, including:</p><ol><li><strong>Remote login and logoff events:</strong> These events are recorded when a user logs in or logs off of the system using RDP. The log entries may contain information about the user who logged in, the IP address of the remote system, and the date and time of the login or logoff.<li><strong>Remote connection and disconnection events:</strong> These events are recorded when a user establishes or terminates an RDP connection to the system. The log entries may contain information about the user who connected, the IP address of the remote system, and the date and time of the connection or disconnection.<li><strong>Remote desktop session events:</strong> These events are recorded when a user starts or ends a remote desktop session using RDP. The log entries may contain information about the user who started or ended the session, the IP address of the remote system, and the date and time of the session start or end.</ol><p><strong>WIN:</strong> 7+ <br /> <strong>SRV:</strong> 2003+</p><h4 id="location-1"><span class="mr-2">Location</span><a href="#location-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>%SYSTEM ROOT%\System32\winevt\logs\Security.evtx
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-1"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here is a table listing some event IDs that may be useful for tracking Remote Desktop Protocol (RDP) usage in the security.evtx log:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Event ID<th>Description<th>Details Recorded<tbody><tr><td style="text-align: center">4624<td>Remote login<td>User who logged in, IP address of remote system, date and time of login<tr><td style="text-align: center">4634<td>Remote logoff<td>User who logged off, IP address of remote system, date and time of logoff<tr><td style="text-align: center">4778<td>Remote connection<td>User who connected, IP address of remote system, date and time of connection<tr><td style="text-align: center">4779<td>Remote disconnection<td>User who disconnected, IP address of remote system, date and time of disconnection<tr><td style="text-align: center">4799<td>Remote desktop session start<td>User who started the session, IP address of remote system, date and time of session start<tr><td style="text-align: center">4800<td>Remote desktop session end<td>User who ended the session, IP address of remote system, date and time of session end</table></div><h4 id="tools-1"><span class="mr-2">Tools</span><a href="#tools-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.eventlogxp.com/">Event Log Explorer</a><li><a href="https://github.com/EricZimmerman/evtx">Event Log Parser (EvtxECmd)</a><li>Native Event Viewer</ul><h4 id="sources-1"><span class="mr-2">Sources</span><a href="#sources-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="http://woshub.com/rdp-connection-logs-forensics-windows/">Woshub - RDP Connection Logs Forensics Windows</a></ul><h2 id="windows-serviceprocess-events"><span class="mr-2">Windows Service/Process Events</span><a href="#windows-serviceprocess-events" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>The system.evtx and security.evtx logs are system logs that are used to record system related events. These logs can contain forensic evidence related to service execution including the user of whom interacted with a service, which can be useful in investigations into cyber crimes, unauthorized access to systems or data, and employee misconduct.</p><p>The system.evtx and security.evtx logs can contain several types of forensic evidence related to service execution and user names, including:</p><ol><li><strong>Service start and stop events:</strong> These events are recorded when a service is started or stopped on the system. The log entries may contain information about the service that was started or stopped, the user who initiated the action, and the date and time of the event.</ol><p><strong>WIN:</strong> 7+ <br /> <strong>SRV:</strong> 2003+</p><h3 id="location-2"><span class="mr-2">Location</span><a href="#location-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>%SYSTEM ROOT%\System32\winevt\logs\System.evtx
%SYSTEM ROOT%\System32\winevt\logs\Security.evtx
</pre></table></code></div></div><h3 id="interpretation-and-investigative-notes-2"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Here is a table listing some event IDs that may be useful for tracking service and process interaction in the security.evtx and system.evtx logs:</p><div class="table-wrapper"><table><thead><tr><th>Event Log<th>Event ID<th>Description<th>Details Recorded<tbody><tr><td>security.evtx<td>4688<td>A new process has been created.<td>The name and command line of the process, the security identifier (SID) of the user who created the process, and the logon ID.<tr><td>security.evtx<td>4697<td>A service was installed in the system.<td>The name of the service, the display name of the service, the security identifier (SID) of the user who installed the service, and the logon ID.<tr><td>system.evtx<td>7034<td>A service terminated unexpectedly.<td>The name of the service, the exit code, and the time the service stopped. Sudden crashing of service can indicate process injection failures.<tr><td>system.evtx<td>7035<td>A service was stopped.<td>The name of the service and the time the service stopped.<tr><td>system.evtx<td>7036<td>A service was started.<td>The name of the service and the time the service started.<tr><td>system.evtx<td>7040<td>The start type of a service was changed.<td>The name of the service, the old start type, and the new start type. Services that are scheduled to start on boot may be indicative of persistence.<tr><td>system.evtx<td>7045<td>A service was installed in the system.<td>The name and display name of the service, the name of the account under which the service is running, and the path to the service executable.</table></div><h4 id="tools-2"><span class="mr-2">Tools</span><a href="#tools-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.eventlogxp.com/">Event Log Explorer</a><li><a href="https://github.com/EricZimmerman/evtx">Event Log Parser (EvtxECmd)</a><li>Native Event Viewer</ul><h4 id="sources-2"><span class="mr-2">Sources</span><a href="#sources-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://blog.mosse-institute.com/digital-forensics/2022/05/11/windows-event-logs.html">Mosse Institute - Digital Forensics - Windows Event Logs</a></ul><h3 id="account-interaction"><span class="mr-2">Account Interaction</span><a href="#account-interaction" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The security.evtx event log can be a useful source of forensic evidence related to user account interaction.</p><p><strong>WIN:</strong> XP+ <br /> <strong>SRV:</strong> 2003+</p><h4 id="location-3"><span class="mr-2">Location</span><a href="#location-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>%SYSTEM ROOT%\System32\winevt\logs\Security.evtx
</pre></table></code></div></div><h4 id="interpretation-and-investigative-notes-3"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p>Here is a table of some useful event IDs for Account interaction in the security.evtx log:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Event ID<th>Description<th>Details Recorded<tbody><tr><td style="text-align: center">4624<td>An account was successfully logged on.<td>The security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type (e.g. interactive logon, network logon, etc.).<tr><td style="text-align: center">4625<td>An account failed to log on.<td>The security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type.<tr><td style="text-align: center">4634<td>An account was logged off.<td>The security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type.<tr><td style="text-align: center">4647<td>User initiated logoff.<td>The security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type.<tr><td style="text-align: center">4648<td>A logon was attempted using explicit credentials.<td>The security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type.<tr><td style="text-align: center">4672<td>Special privileges assigned to new logon.<td>The security identifier (SID) of the user, the user’s account name and domain, and the logon ID.<tr><td style="text-align: center">4720<td>A user account was created.<td>The security identifier (SID) of the user, the user’s account name and domain, and the logon ID.</table></div><p>The Event ID 4624 also contains logon type codes that are used to classify the type of logon that occurred, and can be helpful in understanding how a user logged on to the device. The details recorded for each logon type may vary, but generally include the security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type. The logon type codes are in the table below:</p><div class="table-wrapper"><table><thead><tr><th style="text-align: center">Logon Type Code<th>Logon Type<th>Description<tbody><tr><td style="text-align: center">2<td>Interactive<td>Logon at the console of the local computer.<tr><td style="text-align: center">3<td>Network<td>Logon through a network. The account used is a normal account.<tr><td style="text-align: center">4<td>Batch<td>Batch logon.<tr><td style="text-align: center">5<td>Service<td>Service started by the Service Control Manager.<tr><td style="text-align: center">7<td>Unlock<td>Unlocking the workstation.<tr><td style="text-align: center">8<td>NetworkCleartext<td>Network logon with credentials sent in the clear.<tr><td style="text-align: center">9<td>NewCredentials<td>Network logon with credentials encrypted in the Kerberos ticket.<tr><td style="text-align: center">10<td>RemoteInteractive<td>Logon to a terminal server.<tr><td style="text-align: center">11<td>CachedInteractive<td>Cached domain credentials.<tr><td style="text-align: center">12<td>CachedRemoteInteractive<td>Cached domain credentials for a terminal server. Similar to 10<tr><td style="text-align: center">13<td>CachedUnlock<td>Unlocking a workstation with cached domain credentials. Similar to 7</table></div><h4 id="tools-3"><span class="mr-2">Tools</span><a href="#tools-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://www.eventlogxp.com/">Event Log Explorer</a><li><a href="https://github.com/EricZimmerman/evtx">Event Log Parser (EvtxECmd)</a><li>Native Event Viewer</ul><h4 id="sources-3"><span class="mr-2">Sources</span><a href="#sources-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><ul><li><a href="https://resources.infosecinstitute.com/topic/relevance-of-windows-eventids-in-investigation/">Infosec Institute - Relevance of Windows Event IDs in Investigation</a></ul><h2 id="account-authentication-events"><span class="mr-2">Account Authentication Events</span><a href="#account-authentication-events" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Authentication mechanism artifacts, logging details regarding Local Account and Domain authentication. Details are recorded on system that authenticated the credentials (Domain Controller).</p><ul><li>Local Account = Host Machine<li>Domain Account = Active Directory</ul><p><strong>WIN:</strong> XP+ <br /> <strong>SRV:</strong> 2003+</p><h3 id="location-4"><span class="mr-2">Location</span><a href="#location-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>%SYSTEM ROOT%\System32\winevt\logs\Security.evtx
</pre></table></code></div></div><h3 id="interpretation-and-investigative-notes-4"><span class="mr-2">Interpretation and Investigative Notes</span><a href="#interpretation-and-investigative-notes-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Here is a table of some useful event IDs for account authentication in the security.evtx log:</p><div class="table-wrapper"><table><thead><tr><th>Event ID<th>Description<th>Details Recorded<tbody><tr><td>4776<td>The Domain Controller attempted to validate the credentials for an account.<td>The security identifier (SID) of the user, the user’s account name and domain, the logon ID, and the logon type.<tr><td>4768<td>A Kerberos authentication ticket (TGT) was requested.<td>The security identifier (SID) of the user, the user’s account name and domain, and the logon ID.<tr><td>4769<td>A Kerberos service ticket was requested.<td>The security identifier (SID) of the user, the user’s account name and domain, the name of the service for which the ticket was requested, and the logon ID.<tr><td>4771<td>Kerberos pre-authentication failed.<td>The security identifier (SID) of the user, the user’s account name and domain, the type of failure, and the logon ID.</table></div><h3 id="tools-4"><span class="mr-2">Tools</span><a href="#tools-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="https://www.eventlogxp.com/">Event Log Explorer</a><li><a href="https://github.com/EricZimmerman/evtx">Event Log Parser (EvtxECmd)</a><li>Native Event Viewer</ul><h3 id="sources-4"><span class="mr-2">Sources</span><a href="#sources-4" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li><a href="https://resources.infosecinstitute.com/topic/relevance-of-windows-eventids-in-investigation/">Infosec Institute - Relevance of Windows Event IDs in Investigation</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dfir/'>DFIR</a>, <a href='/categories/evidence-artifacts/'>Evidence Artifacts</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/rdp/" class="post-tag no-text-decoration" >rdp</a> <a href="/tags/port-3389/" class="post-tag no-text-decoration" >port:3389</a> <a href="/tags/evtx-security/" class="post-tag no-text-decoration" >evtx:security</a> <a href="/tags/evtx-system/" class="post-tag no-text-decoration" >evtx:system</a> <a href="/tags/persistence-ta0003/" class="post-tag no-text-decoration" >persistence (TA0003)</a> <a href="/tags/privilege-escalation-ta0004/" class="post-tag no-text-decoration" >privilege escalation (TA0004)</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Evidence+of+Account+Usage+-+darkcybe&url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Account_Usage%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Evidence+of+Account+Usage+-+darkcybe&u=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Account_Usage%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Account_Usage%2F&text=Evidence+of+Account+Usage+-+darkcybe" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FDFIR_Evidence_of_Account_Usage%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DFIR_Evidence_of_Account_Usage/">Evidence of Account Usage</a><li><a href="/posts/DFIR_Evidence_of_Execution/">Evidence of Execution</a><li><a href="/posts/Active_Directory/">Active Directory</a><li><a href="/posts/Command_and_Control/">Command and Control</a><li><a href="/posts/ETH_Overview/">Ethical Hacking Overview</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/DFIR_Evidence_of_Lateral_Movement/"><div class="card-body"> <em class="small" data-ts="1662818400" data-df="ll" > Sep 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Evidence of Lateral Movement</h3><div class="text-muted small"><p> Techniques that can be used to discover evidence in support of lateral movement through a network using various techniques. Windows Remote Desktop Protocol (RDP) Usage Track RDP logins between re...</p></div></div></a></div><div class="card"> <a href="/posts/Token_Impersonation/"><div class="card-body"> <em class="small" data-ts="1666616400" data-df="ll" > Oct 25, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CAPEC 633 - Token Impersonation</h3><div class="text-muted small"><p> Overview An adversary exploits a weakness in authentication to create an access token (or equivalent) that impersonates a different entity, and then associates a process/thread to that that impers...</p></div></div></a></div><div class="card"> <a href="/posts/Persistence/"><div class="card-body"> <em class="small" data-ts="1664974800" data-df="ll" > Oct 6, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Persistence</h3><div class="text-muted small"><p> Overview The adversary is trying to maintain their foothold. Persistence consists of techniques that adversaries use to keep access to systems across restarts, changed credentials, and other inte...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/DFIR_Overview/" class="btn btn-outline-primary" prompt="Older"><p>DFIR Overview</p></a> <a href="/posts/DFIR_Evidence_of_Download/" class="btn btn-outline-primary" prompt="Newer"><p>Evidence of Download</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/darkcybe">darkcybe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QFH2BQ5ZG5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QFH2BQ5ZG5'); }); </script>
