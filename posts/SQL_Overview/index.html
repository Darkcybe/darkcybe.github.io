<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="SQL Overview" /><meta property="og:locale" content="en" /><meta name="description" content="Overview" /><meta property="og:description" content="Overview" /><link rel="canonical" href="https://darkcybe.github.io/posts/SQL_Overview/" /><meta property="og:url" content="https://darkcybe.github.io/posts/SQL_Overview/" /><meta property="og:site_name" content="darkcybe" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-02T00:00:00+10:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="SQL Overview" /><meta name="twitter:site" content="@darkcybe" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-10-02T19:16:36+11:00","datePublished":"2022-10-02T00:00:00+10:00","description":"Overview","headline":"SQL Overview","mainEntityOfPage":{"@type":"WebPage","@id":"https://darkcybe.github.io/posts/SQL_Overview/"},"url":"https://darkcybe.github.io/posts/SQL_Overview/"}</script><title>SQL Overview | darkcybe</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="darkcybe"><meta name="application-name" content="darkcybe"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo/darkcybe.gif" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">darkcybe</a></div><div class="site-subtitle font-italic">This is the security blog you've been looking for</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/whoami/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>WHOAMI</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/darkcybe" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/darkcybe" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://discordapp.com/users/darkcybe#4349" aria-label="discord" target="_blank" rel="noopener"> <i class="fab fa-discord"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="" aria-label="" target="_blank" rel="noopener"> <i class=""></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>SQL Overview</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>SQL Overview</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1664632800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 2, 2022 </em> </span> <span> Updated <em class="" data-ts="1664698596" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 2, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/darkcybe">darkcybe</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2668 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><h1 id="overview">Overview</h1><p>Structured Query Language (SQL) is designed for managing data held in a <a href="https://en.wikipedia.org/wiki/Relational_database_management_system">relational database management system</a> (RDBMS). It is particularly useful in handling structured data, i.e. data incorporating relations among entities and variables. SQL Server is a product developed by Microsoft to manage relational databases, storing and retrieving data requested by other applications. There are various topics regarding SQL and cyber security ranging from the protection of databases, SQL Injection attacks and database manipulation. This post however, serves as a fundamental overview of the SQL database programming and server.</p><h1 id="database-concepts">Database Concepts</h1><p>A relational database is designed to organize a collection of data, typically stored and accessed electronically from a computer system or electronic device and is regularly referenced and altered by software applications. There are three generic styles of databases, with SQL focusing on the later, Relational Databases.</p><ul><li>Hierarchical: Think directory structure<li>Flat-file: CSV, Excel, Delimited<li>Relational: MSSQL, MySQL, and more<ul><li>Tables: Think an excel page<li>Columns: Data headers<li>Rows: Data values</ul></ul><h1 id="sql-sub-languages">SQL Sub-languages</h1><h2 id="data-manipulation-language-dml"><span class="mr-2">Data Manipulation Language (DML)</span><a href="#data-manipulation-language-dml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>DML is an SQL sub-language that deals with the manipulation of data records stored within the database tables. It does not deal with changes to database objects or its structure. Some commonly used examples of DML are as in the table below:</p><div class="table-wrapper"><table><thead><tr><th>Statement<th>Description<th>Code Example<tbody><tr><td>SELECT<td>Retrieve rows from database and enables select of one or many rows or columns<td>SELECT SalesOrderID, SUM(LineTotal) AS SubTotal<br />FROM Sales.SalesOrderDetail<tr><td>INSERT<td>Adds one or more rows to a table or view<td>INSERT INTO table_name (column1, column2)<br />VALUES (value1, value2)<br /> <br />INSERT INTO table_name<br />VALUES (value1, value2, value3)<tr><td>UPDATE<td>Changes existing data in a table or view<td> <tr><td>DELETE<td>Removes one or more rows from a table or view<td>DELETE FROM table_name<br />WHERE [condition];<tr><td>MERGE<td>Performs insert, update, or deletes on a target table based on the results of a join with a source table<td> <tr><td>BULK INSERT<td>Imports a data file into a database table or view<td> </table></div><h2 id="data-definition-language-dml"><span class="mr-2">Data Definition Language (DML)</span><a href="#data-definition-language-dml" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Unlike DML above, DDL defines data structures and is used to update or modify objects rather than the data contained within them. The below table lists the more common DDL statements used:</p><div class="table-wrapper"><table><thead><tr><th>Statement<th>Description<th>Code Example<tbody><tr><td>CREATE<td>Enables creating an item in SQL Server. For example, database, table, view, users, index and more<td>CREATE DATABASE database_name<tr><td>ALTER<td>Enables modification of an existing object<td> <tr><td>DROP<td>Drops and existing object<td>DROP TABLE table_name<tr><td>COLLATION<td>Defines the collation of a database or table column, or a collation cast operation when applied toa character string expression. Assigns certain characteristics to data.<td> <tr><td>USE<td>Changes the database context to the specified database (Switch between databases)<td>USE database_name</table></div><h1 id="database-objects">Database Objects</h1><h2 id="data-types"><span class="mr-2">Data Types</span><a href="#data-types" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Data Types are an attribute that specifies the type of data an object can hold, such as date and time, binary strings, monetary data, integer data. Data Types have several characteristics:</p><ul><li>Each column, local variable, expression, and parameter has a related data type.<li>Data type of the results is determined by the applying rules of data type precedence to data types of input expressions (handled by the SQL Server engine).<li>Collation of result is determined by rules of the collation precedence when result data type is char, varchar, text, nchar, ntext.<li>Precision, scale, and length of a result depend on precision, scale, and length of input expressions.</ul><div class="table-wrapper"><table><thead><tr><th>Data Type<th>Statement<th>Description<th>Storage<tbody><tr><td>Approximate Numeric<td>FLOAT<td>Approximate-number data type to store the mantissa of the float number in scientific notation and dictates the precision and storage size. The default value of n = 53.<td>FLOAT[(n)]: (n = 1 to 24) 7 digits and 4 bytes<br />FLOAT[(n)]: (n = 25 to 53) 15 digits and 8 bytes<tr><td>Binary Strings<td>BINARY<td>Fixed-length binary data.<td>BINARY[(n)]: (n = 1 to 8000) n bytes<tr><td>Character Strings<td>CHAR<td>Fixed-length string data.<td>CHAR[(n)]: (n =1 to 8000 bytes) n x 2 bytes<tr><td>Date and Time<td>DATE<td>Defines a date in SQL Server<td> <tr><td>Exact Numeric<td>TINYINT, SMALLINT, INT, BIGINT<td>Exact-number data types that use integer data. Always use the smallest data type for your purpose!<td>TINYINT: 0 to 255 : 1 byte<br />SMALLINT: -2^15 to 2^15 : 2 bytes<br />INT: 2^31 to 2^32 : 4 bytes<br />BIGINT: -2^63 to 2^63 : 8 bytes<tr><td>Miscellaneous<td>CURSOR<td>For variables or stored procedure OUTPUT parameters that contain a reference to a cursor.<td> <tr><td>Unicode Character Strings<td>NCHAR<td>Fixed-length string data.<td>NCHAR[(n)]: (n = string length in byte-pairs, n = 1 to 4000) n x 2 bytes<tr><td> <td>DECIMAL, NUMERIC<td>Fixed precision and scale. Scale is number of decimals to the right of a decimal point (1 to 38 bytes with a default of 18)<td>-10^38 + 1 to 10^38 -1<tr><td> <td>SMALLMONEY, MONEY<td>Accurate to a ten-thousandth. Use a period to separate monetary units such as cents.<td>SMALLMONEY: 4 bytes<br />MONEY: 8 bytes<tr><td> <td>REAL<td>7 digits of precision making it identical to float(24).<td>4 bytes<tr><td> <td>NVARCHAR<td>Variable-length string data.<td>NVARCHAR[(n)]: (n = string length in byte-pairs, n = 1 to 4000) n x 2 bytes<tr><td> <td>IMAGE<td>Variable-length binary blob data (images, documents, files, etc).<td>IMAGE[(n)]: (n = 0 to 2^31 -1 bytes) 2GB<tr><td> <td>VARBINARY<td>Variable-length binary data.<td>VARBINARY[(n)]: (n = 1 to 8000)<br />VARBINARY[(MAX)]: (n = 1 to 2^31 -1) 2GB, storage is the actual length of the data + 2 bytes.<tr><td> <td>DATETIME<td>Date with time of day with fractional seconds and based on 24-hour clock.<td> <tr><td> <td>DATETIME2<td>Expanded datetime with larder date range, default fractional precision, and user-specified precision.<td> <tr><td> <td>DATETIMEOFFSET<td>Date and time of day that has the time zone awareness and based on 24-hour clock.<td> <tr><td> <td>SMALLDATETIME<td>Datetime without seconds or fractional seconds.<td> <tr><td> <td>VARCHAR<td>Variable-length string data.<td>VARCHAR[(n)]: (n = 1 to 8000)<br />VARCHAR[(MAX)]: (n = 1 to 2^31 -1) 2GB, storage is the actual length of the data + 2 bytes.<tr><td> <td>TEXT<td>Variable-length non-Unicode data in the code page of the server<td>2^31 -1 (2GB)<tr><td> <td>ROWVERSION<td>Exposes automatically generated, unique binary numbers within a database that are generally used a mechanism for version-stamping table rows.<td> <tr><td> <td>HIERARCHYID<td>Variable-length, system data type that represents a position in a tree hierarchy.<td> <tr><td> <td>UNIQUEGUIDIDENTIFIER<td>6-byte GUID created from NEWID or NEWSEQUENTIALID functions or converting a string constant in a certain format.<td> <tr><td> <td>SQL_VARIANT<td>Stores values of various SQL Server-supported data types.<td> <tr><td> <td>XML<td>Stores XML data<td> <tr><td> <td>SPATIAL GEOMETRY AND GEOGRAPHY TABLES<td>Implemented as a .NET common language runtime (CLR) data type for storing location specific data.<td> <tr><td> <td>TABLE<td>Primarily used for temporary storage of a set of rows returned as the result of a table-valued function.<td> </table></div><h2 id="tables-and-views"><span class="mr-2">Tables and Views</span><a href="#tables-and-views" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>Tables</strong></p><ul><li>Tables contain all the data in the database in a row-and-column format<li>A table can have 1024 columns, and 30000 columns if using SPARSE<li>Assign properties to a table and columns to use compression (by row or page)</ul><p><strong>Views</strong></p><ul><li>Virtual table defined by a query<li>Similar to a table with named columns and rows that are produced dynamically when referenced<li>Acts like a filter on tables and can reference multiple tables and provide a level of security (access to pre-created views can be assigned to a user instead of giving a user access to tables)</ul><h2 id="stored-procedures-and-functions"><span class="mr-2">Stored Procedures and Functions</span><a href="#stored-procedures-and-functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="stored-procedures"><span class="mr-2">Stored Procedures</span><a href="#stored-procedures" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(%DATABASE%\Programmability\Stored Procedures)
</pre></table></code></div></div><p>A subroutine available to applications that access a DB System, when creating a stored procedure <code class="language-plaintext highlighter-rouge">CTL+SHIFT+M</code> can be used to enter a templated view.</p><ul><li>A group of one or more Transact-SQL (T-SQL) statements or a reference to a Microsoft .Net Framework CLR method.<li>Can accept input parameters and return multiple values as output parameters<li>Have programming statements that perform operations within the database<li>Return a status value indicating success or failure</ul><p>Using stored procedures has a few benefits.</p><ul><li>Reduces server/client network traffic by saving the procedures on the server and only return the result to the client.<li>Stronger security by containing stored procedures that have been validated and tested. Avoids SQL injection attackers where a client could manifest their own query.<li>Reuse of Code – Write a stored procedure once and use it with multiple applications instead of writing the same code into multiple applications.<li>Easier maintenance for applications, no changes in the client application<li>Improved performance, speeds up network utilization and server execution.</ul><h3 id="functions"><span class="mr-2">Functions</span><a href="#functions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>(%DATABASE%\Programmability\Functions)
</pre></table></code></div></div><p>Functions are routines that accept parameters, perform and action, and return the result of that action as a value.</p><ul><li>Allows for modular programming, faster execution, reduction of network traffic, scalar function, table-valued functions and system functions to return needed information.</ul><p><img data-src="/assets/img/posts/GEN/Programming/SQL_Overview_SP.png" alt="Stored Procedure Example" title="Stored Procedure Example" data-proofer-ignore></p><h1 id="data-manipulation">Data Manipulation</h1><h2 id="data-selection"><span class="mr-2">Data Selection</span><a href="#data-selection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Selecting data is the most common statement used by applications to query data in the database. The below table displays the common statement and query clauses.</p><div class="table-wrapper"><table><thead><tr><th>Statement<th>Description<th>Example<tbody><tr><td>SELECT<td>Retrieves rows from the database and enables you to select one or more columns or rows from one or many tables.<td>SELECT * INTO copyoftableName FROM tableName<tr><td>FROM<td>Specifies the tables, views, derived tables, and joined tables using in DELETE, SELECT, and UPDATE statements.<td>SELECT SalesOrderID, SUM(LineTotal) AS SubTotal<br />FROM Sales.SalesOrderDetail<tr><td>GROUP BY<td>Clause that divides the query result into groups of rows, typically for performing aggregations.<td>SELECT SalesOrderID, SUM(LineTotal) AS SubTotal<br />FROM Sales.SalesOrderDetail<br />GROUP BY SalesOrderID<tr><td>HAVING<td>Typically used with GROUP BY in a SELECT statement as a search condition for a group or an aggregate.<td>SELECT SalesOrderID, SUM(LineTotal) AS SubTotal<br />FROM Sales.SalesOrderDetail<br />GROUP BY SalesOrderID<br />HAVING SUM(LineTotal) &gt; 100000.00<tr><td>ORDER BY<td>Orders result set of a query by the specific column list.<td>SELECT SalesOrderID, SalesOrderItem<br />FROM Sale.SalesOrderID<br />ORDER BY SalesOrderID<tr><td>UNION<td>Combines results of two or more queries into a single results set that has all rows of each query in the union.<td> <tr><td>EXCEPT<td>Returns distinct rows from left input query that aren’t output by right input query.<td> <tr><td>INTERSECT<td>Returns distinct rows that are output by both left and righty input queries.<td> <tr><td>JOIN<td>Defines the way two tables are related in a query.<td> <tr><td>TRUNCATE<td>Removes all rows from a table or specified partitions of a table but doesn’t log row deletions making it much faster than DELETE if removing all rows in a table by using fewer system and transaction log resources.<td>TRUNCATE TABLE TableName</table></div><h2 id="data-modification"><span class="mr-2">Data Modification</span><a href="#data-modification" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Changes existing data in a table or view, covered in above section on DML.</p><h2 id="deleting-data"><span class="mr-2">Deleting Data</span><a href="#deleting-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Used to delete existing records in a table, covered in above section on DML.</p><dl><dt>DELETE<dd>Permissions are required on the target table as well as SELECT permissions if the statement contains a WHERE clause (and if no WHERE clause is used, all records will be deleted).<dt>TRUNCATE<dd>Is another statement used to delete rows and requires the ALTER permission on the specific table.</dl><h2 id="inserting-data"><span class="mr-2">Inserting Data</span><a href="#inserting-data" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Allows you to insert new records into a table. If adding values for all columns in a table, there is no need to specify the column names, otherwise order of values must match order of columns.</p><blockquote><p>INSERT permission is required.</p></blockquote><h1 id="data-storage">Data Storage</h1><h2 id="normalization"><span class="mr-2">Normalization</span><a href="#normalization" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Database design technique that makes databases more efficient. Resolves issues of data redundancy and improves storage, data integrity and scalability. Also helps reduce INSERT, UPDATE, and DELETE anomalies.</p><p>Normalization is structured under certain ‘Normal Forms’ as per the table below. Most organizations will design their database to 3NF.</p><div class="table-wrapper"><table><thead><tr><th>Statement<th>Description<tbody><tr><td>First Normal Form (1NF)<td>Eliminated repeating groups. No duplicate records exist in table and no multi-valued attributes. All entries in the column are of the same data type.<tr><td>Second Normal Form (2NF)<td>Table is already 1NF, all partial dependencies are removed to another table(s).<tr><td>Third Normal Form (3NF)<td>Table is already 2NF, eliminate non-dependent columns and transient dependencies.<tr><td>Fourth Normal Form (4NF)<td>Already 3NF, no independent multiple relationships.<tr><td>Fifth Normal Form (5NF)<td>Already 4NF, isolate semantically-related relationships.</table></div><h2 id="keys"><span class="mr-2">Keys</span><a href="#keys" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Keys are the set of attributes that used to identify the specific row in a table and to find or create the relation between two or more tables i.e keys identify the rows by combining one or more columns. The table below identifies the main three keys:</p><div class="table-wrapper"><table><thead><tr><th>Key Type<th>Description<tbody><tr><td>Primary Key (PK)<td>Uniquely identifies each record in a table.<br />– Cannot contain NULL values, must be UNIQUE<br />– Only one Primary Key per table, using single or multiple fields<tr><td>Foreign Key (FK)<td>Not just to a primary key constraint in another table, can reference columns of a UNIQUE constraint in another table.<br />– Can only reference tables within the same database on the same server<br />– Self-reference is allowed to reference another column in the same table<br />– Column-level constraint must list only one reference column and be the same data type<br />– Table-level constraint needs same number of reference columns and data types<tr><td>Composite Key<td>A key that includes multiple columns. Can be designated as the primary key if the combination of the columns result in a unique composite value for every row in the table. Commonly used in tables designed with many to many relationships.</table></div><h1 id="database-administration">Database Administration</h1><h2 id="authentication-users-roles-and-permissions"><span class="mr-2">Authentication, Users, Roles, and Permissions</span><a href="#authentication-users-roles-and-permissions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>How to connect and login to access resources. There are multiple methods to authenticate.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>%SQL_SERVER%\Security\Logins\
</pre></table></code></div></div><div class="table-wrapper"><table><thead><tr><th>Authentication Method<th>Description<th>Additional<tbody><tr><td>Windows Authentication<td>Commonly referred to as Integrated Security<td>Preferred method as it provides a single sign-on for the OS and SQL Server. Windows Groups can be used to manage access.<tr><td>SQL Server and Windows Authentication<td>Commonly referred to as Mixed-mode Security<td>SQL Logins allow application-specific security and mixes OS access.<br />– SQL Server Login: Server Role<br />– Database User: Role, Application Role, or Group</table></div><p><strong>SQL Server Authentication</strong></p><div class="table-wrapper"><table><thead><tr><th>Account<th>Description<tbody><tr><td>Sysadmin<td>Superuser role for the Server<tr><td>Database Users<td>Windows Logins<br />SQL Logins<br />Windows Groups (AD)<br />User without login<tr><td>Database Owner (DBO)<td>Database Owner, mapped to Sysadmin<tr><td>Guest<td>Logins without mapping are guest accounts. Recommended to disable.</table></div><p><strong>SQL Server Accounts</strong></p><div class="table-wrapper"><table><thead><tr><th>Role<th>Description<tbody><tr><td>Db_owner<td>Perform all configuration and maintenance, including dropping a database<tr><td>Db_securityadmin<td>Modify role membership and manage permissions<tr><td>Db_accessadmin<td>Add or remove access to the database for Windows logins or groups, and SQL Server logins<tr><td>Db_backupoperator<td>Can backup the database<tr><td>Db_ddladmin<td>Can run any DDL command in a database<tr><td>Db_datawriter<td>Can add, delete, or change data in all user tables<tr><td>Db_datareader<td>Can read all data from all user tables<tr><td>Db_denydatawriter<td>Restricts modification of data explicitly<tr><td>Db_denydatareader<td>Restricts the reading of data from a database<tr><td>Public<td>Assigned to all users</table></div><p><strong>Database Roles</strong></p><div class="table-wrapper"><table><thead><tr><th>Permission<th>Description<tbody><tr><td>GRANT<td>Positive privilege<tr><td>DENY<td>Negative privilege<tr><td>REVOKE<td>Negates a GRANT or DENY<tr><td>ALTER<td>Make changes to database objects<tr><td>BACKUP<td>Backup Objects<tr><td>CONTROL<td>Grants full access to objects<tr><td>CREATE<td>Create Objects<tr><td>DELETE<td>Delete objects<tr><td>DROP<td>Drop databases or tables<tr><td>SELECT<td>Select or read data from a table or view<tr><td>ENDPOINTs (Instance-Level)<td>Sets configuration for access to the SQL Server instance. TCP/IP or network restrictions.<tr><td>ASSEMBLY and SERVICEs (Database-Level)<td>ASSEMBLY references a .DLL, uploading an ASSEMBLY is the first step to allowing application roles and client access.<tr><td>TABLEs, VIEWs, PROCEDUREs, and QUEUEs (Schema-Level)<td>Allows the locking down of access to specific tables, views, etc.<tr><td>(Column-Level)<td>Restrict permissions to only specific columns</table></div><p><strong>Permissions</strong></p><p>There are many permissions that can be applied to an account in a granular access model. ~200 exposed permissions. Common permissions are as above in the Permissions table.</p><h2 id="maintenance-tasks"><span class="mr-2">Maintenance Tasks</span><a href="#maintenance-tasks" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Considerations to take when maintaining a SQL Server instance are typically based in the following table:</p><div class="table-wrapper"><table><thead><tr><th>Task<th>Description<tbody><tr><td>Statistics<td>Used by the Query Optimize to compile an optimal execution plan. “Auto Update Statistics” is built-in and available to automatically do this.<tr><td>Index<td>Fragmentation naturally occurs due to inserts, updates, and deletes and can impact performance negatively. To control fragmentation, the following methods can be employed.<br />– Rebuild, reorganize, or disable-and-rebuild the index<br />– Database Maintenance Plans<br />– Custom Scripts in a SQL Agent Job<br />– Third party tools<tr><td>Consistency Checks<td>Corruption can occur, typically based on IO (disk Input/output). There are built-in checks to assist in identifying database corruption.<br />– DBCC CHECKDB<br />– DBCC CHECKALLOC<br />– DBCC CHECKCATALOG<br />– DBCC CHECKFILEGROUP<br />– DBCC CHECKTABLE</table></div><p><strong>Backups and Disaster Recovery (DR)</strong></p><div class="table-wrapper"><table><thead><tr><th>Backup Type<th>Description<th>Code Example<tbody><tr><td>Full<td>All data in the database is backed up<td>BACKUP DATABASE<tr><td>Differential<td>Only backs up changed data from the last Full Backup<td>BACKUP DATABASE<br />WITH DIFFERENTIAL<tr><td>Transaction Log<td>A log of all transactions carried out on the database<td>BACKUP LOG<tr><td>Copy-Only Backup<td>An ‘out-of-band’ backup that can be used to an immediate backup that doesn’t impact previously set backup strategies.<td> </table></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/general-it-and-security/'>General IT and Security</a>, <a href='/categories/programming/'>Programming</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/sql/" class="post-tag no-text-decoration" >sql</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=SQL+Overview+-+darkcybe&url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FSQL_Overview%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=SQL+Overview+-+darkcybe&u=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FSQL_Overview%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FSQL_Overview%2F&text=SQL+Overview+-+darkcybe" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fdarkcybe.github.io%2Fposts%2FSQL_Overview%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/DFIR_Evidence_of_Account_Usage/">Evidence of Account Usage</a><li><a href="/posts/DFIR_Evidence_of_Execution/">Evidence of Execution</a><li><a href="/posts/Active_Directory/">Active Directory</a><li><a href="/posts/Command_and_Control/">Command and Control</a><li><a href="/posts/ETH_Overview/">Ethical Hacking Overview</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Database_Stores/"><div class="card-body"> <em class="small" data-ts="1664632800" data-df="ll" > Oct 2, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Database Stores</h3><div class="text-muted small"><p> Overview Relational and Non-Relational databases are a valuable target for attackers, with sensitive information often stored within the database tables such as Personally Identifiable Information...</p></div></div></a></div><div class="card"> <a href="/posts/Python_Overview/"><div class="card-body"> <em class="small" data-ts="1662904800" data-df="ll" > Sep 12, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Python Overview</h3><div class="text-muted small"><p> Python is an easy to understand, interpreted programming language that is commonly used across the cybersecurity community. Data Types Integers and Strings Integers are set without quotation and ...</p></div></div></a></div><div class="card"> <a href="/posts/C-_Overview/"><div class="card-body"> <em class="small" data-ts="1663336800" data-df="ll" > Sep 17, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C# Overview</h3><div class="text-muted small"><p> Overview OOP is the foundation of many development languages, building classes and organizing the code into a structured way.  Many approaches, patterns and architectures are compatible with OOP. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/FTP_21/" class="btn btn-outline-primary" prompt="Older"><p>Port 21 - FTP</p></a> <a href="/posts/AppCompatCacheParser/" class="btn btn-outline-primary" prompt="Newer"><p>AppCompatCacheParser</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/darkcybe">darkcybe</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/credential-access-ta0006/">credential access (TA0006)</a> <a class="post-tag" href="/tags/execution-ta0002/">execution (TA0002)</a> <a class="post-tag" href="/tags/aitm/">aitm</a> <a class="post-tag" href="/tags/execution-t0002/">execution (T0002)</a> <a class="post-tag" href="/tags/lateral-movement-ta0008/">lateral movement (TA0008)</a> <a class="post-tag" href="/tags/mitm/">mitm</a> <a class="post-tag" href="/tags/nmap/">nmap</a> <a class="post-tag" href="/tags/ntlmv2/">ntlmv2</a> <a class="post-tag" href="/tags/privilege-escalation-ta0004/">privilege escalation (TA0004)</a> <a class="post-tag" href="/tags/responder/">responder</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-QFH2BQ5ZG5"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-QFH2BQ5ZG5'); }); </script>
